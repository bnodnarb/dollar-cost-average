<html>
  <head>

    <!--
    ABOUT:
    - We believe in the ethos of verification
    - This HTML script can run in any modern browser
    - This project does not require an internet connection

    AUTHENTICITY VERIFICATION:
    - This HTML project uses Forge, a popular open source library to sign orders with your Binance Secret API Key: https://github.com/digitalbazaar/forge
    - We are using Forge v7.0, which is currently the most widely adopted version of Forge: https://cdn.jsdelivr.net/npm/node-forge@0.7.0/dist/forge.min.js
    - To verify the authenticity of the Forge cryptography utilities contained in this project, we recommend running a SHA256 checksum against the 'forge.min.js' file
    - Expected matching SHA256 checksum of 'forge.min.js': 4b4f042f9ea6c72a580e93b7922b1ff89f2c1fca28a5843ab473db79cd74d1a7
    -->

    <style>
      input, button, select {
        width: 250px;
        height: 30px;
      }
    </style>

    <script src='https://cdn.jsdelivr.net/npm/node-forge@0.7.0/dist/forge.min.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>

    <script>
      window.onload=function(){
        new ClipboardJS('.btn');
      }
      function generateSignedOrders() {

        api_key = document.getElementById('api_key').value;
        secret = document.getElementById('api_secret').value;
        orders = JSON.parse(document.getElementById('orders').value);

        for (var i = 0; i < orders.length; i++) {
          var order = orders[i];
          var params = {
              symbol: order.symbol,
              side: 'BUY',
              type: 'MARKET',
              quantity: order.quantity,
              recvWindow: 60000,
              timestamp: Math.floor(Date.now() / 1000) * 1000
          };

          queryString = Object.keys(params).map(function(k) {
              return encodeURIComponent(k) + '=' + encodeURIComponent(params[k])
          }).join('&')

          var hmac = forge.hmac.create();
          hmac.start('sha256', secret);
          hmac.update(queryString);
          signature = hmac.digest().toHex();

          orders[i].signedOrder = queryString + "&signature=" + signature + "&api_key=" + api_key;;
        }
        console.log(orders);
        document.getElementById("signed_orders").innerHTML = '<pre>' + JSON.stringify(orders,null,2) + '</pre>';
      }
    </script>

  </head>
  <body>

    <p><input type="password" id="api_key" placeholder="Binance API Key"> <i>Your Binance API Key</i></p>
    <p><input type="password" id="api_secret" placeholder="Binance API Secret"> <i>Your Binance API Secret Key</i></p>
    <p><textarea name="orders" id="orders" placeholder="Orders" rows="25" cols="80"></textarea></p>
    <p><button id="generate_signed_orders" onclick="generateSignedOrders();">Generate Signed Orders</button></p>
    <p><div id="signed_orders"></div></p>

  </body>
</html>
